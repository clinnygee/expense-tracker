{"ast":null,"code":"var _jsxFileName = \"/home/clinnygee/Documents/portfolio-projects/expense-tracker/src/user-context.js\";\nimport React, { createContext } from 'react';\nconst UserContext = createContext({\n  username: '',\n  transactions: [],\n  _id: '',\n  imageHex: '',\n  authenticated: false,\n  jwt: '',\n  updateUserData: () => {},\n  logInSuccess: () => {},\n  signOut: () => {},\n  setJwt: () => {},\n  getUserData: () => {},\n  requestUpdate: () => {},\n  selectedMonth: '',\n  selectedYear: '',\n  updateSelectedMonth: () => {},\n  updateSelectedYear: () => {}\n});\nexport class UserProvider extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.updateUserData = newUserData => {\n      console.log(newUserData);\n      newUserData.transactions.sort((a, b) => {\n        return new Date(b.date) - new Date(a.date);\n      });\n      console.log(newUserData.transactions);\n      this.setState({\n        username: newUserData.username,\n        transactions: newUserData.transactions,\n        _id: newUserData._id,\n        imageHex: newUserData.settings.img.data.data\n      });\n    };\n\n    this.logInSuccess = () => {\n      console.log('in context loginsuccess');\n      this.setState({\n        authenticated: true\n      });\n      this.getUserData();\n    };\n\n    this.setJwt = jwt => {\n      console.log('in context setjwt');\n      this.setState({\n        jwt: jwt\n      });\n    };\n\n    this.signOut = () => {\n      this.setState({\n        authenticated: false\n      });\n      sessionStorage.removeItem('jwt');\n    };\n\n    this.getUserData = () => {\n      let token = sessionStorage.getItem('jwt');\n      fetch('/dashboard', {\n        method: 'GET',\n        headers: {\n          'content-type': 'application/json',\n          'Authorization': \"Bearer \".concat(token)\n        }\n      }).then(response => {\n        return response.json();\n      }).then(parsedJson => {\n        console.log(parsedJson);\n        this.updateUserData(parsedJson); // this.setTransactionData(parsedJson.transactions);\n      });\n    };\n\n    this.requestUpdate = () => {\n      console.log('update requested');\n      this.getUserData();\n    };\n\n    this.updateSelectedMonth = month => {\n      console.log('in updateSelectedMonth, month: ' + this.state.selectedMonth);\n      this.setState({\n        selectedMonth: month\n      });\n    };\n\n    this.updateSelectedYear = year => {\n      console.log('in updateSelected year, year: ' + this.state.selectedYear);\n      this.setState({\n        selectedYear: year\n      });\n    };\n\n    this.state = {\n      username: '',\n      transactions: [],\n      _id: '',\n      imageHex: null,\n      selectedMonth: new Date().getMonth(),\n      selectedYear: new Date().getFullYear(),\n      updateUserData: this.updateUserData,\n      logInSuccess: this.logInSuccess,\n      setJwt: this.setJwt,\n      signOut: this.signOut,\n      getUserData: this.getUserData,\n      requestUpdate: this.requestUpdate,\n      updateSelectedMonth: this.updateSelectedMonth,\n      updateSelectedYear: this.updateSelectedYear\n    };\n  }\n\n  render() {\n    return React.createElement(UserContext.Provider, {\n      value: this.state,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, this.props.children);\n  }\n\n}\n;\nexport const UserConsumer = UserContext.Consumer;","map":{"version":3,"sources":["/home/clinnygee/Documents/portfolio-projects/expense-tracker/src/user-context.js"],"names":["React","createContext","UserContext","username","transactions","_id","imageHex","authenticated","jwt","updateUserData","logInSuccess","signOut","setJwt","getUserData","requestUpdate","selectedMonth","selectedYear","updateSelectedMonth","updateSelectedYear","UserProvider","Component","newUserData","console","log","sort","a","b","Date","date","setState","settings","img","data","sessionStorage","removeItem","token","getItem","fetch","method","headers","then","response","json","parsedJson","month","state","year","getMonth","getFullYear","render","props","children","UserConsumer","Consumer"],"mappings":"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","sourcesContent":["import React, {createContext} from 'react';\n\n\nconst UserContext = createContext({\n    username: '',\n    transactions: [],\n    _id: '',\n    imageHex: '',\n    authenticated: false,\n    jwt: '',\n    updateUserData: () => {},\n    logInSuccess: () => {},\n    signOut: () => {},\n    setJwt: () => {},\n    getUserData: () => {},\n    requestUpdate: () => {},\n    selectedMonth: '',\n    selectedYear: '',\n    updateSelectedMonth: () => {},\n    updateSelectedYear: () => {},\n});\n\nexport class UserProvider extends React.Component {\n\n    \n    // Change this to be a fetch call, so it can be called when a refresh is required when data is changed on the server, \n    // and when the user successfully logs in\n    updateUserData = newUserData => {\n        console.log(newUserData);\n        newUserData.transactions.sort((a, b) => {\n            return new Date(b.date) - new Date(a.date);\n        })\n        console.log(newUserData.transactions);\n        this.setState({username: newUserData.username, transactions: newUserData.transactions, _id: newUserData._id, imageHex: newUserData.settings.img.data.data})\n    };\n    // When this is called, call the function to fetch user data.\n    logInSuccess = () => {\n        console.log('in context loginsuccess')\n        this.setState({authenticated: true});\n        this.getUserData()\n        \n    };\n\n    setJwt = jwt => {\n        console.log('in context setjwt')\n        this.setState({jwt: jwt});\n    };\n\n    signOut = () => {\n        this.setState({authenticated: false});\n        sessionStorage.removeItem('jwt');\n    };\n\n    getUserData = () => {\n        let token = sessionStorage.getItem('jwt');\n\n        fetch('/dashboard', {\n            method: 'GET',\n            headers: {\n                'content-type': 'application/json',\n                'Authorization': `Bearer ${token}`,\n            }\n        }).then(response => {\n            return response.json();\n        }).then(parsedJson => {\n            console.log(parsedJson);\n            this.updateUserData(parsedJson);\n            // this.setTransactionData(parsedJson.transactions);\n        })\n    };\n\n    requestUpdate = () => {\n        console.log('update requested');\n        this.getUserData();\n    }\n\n    updateSelectedMonth = (month) => {\n        console.log('in updateSelectedMonth, month: ' + this.state.selectedMonth)\n        this.setState({selectedMonth: month});\n    };\n\n    updateSelectedYear = (year) => {\n        console.log('in updateSelected year, year: ' + this.state.selectedYear)\n        this.setState({selectedYear: year});\n    };\n\n    state = {\n        username: '',\n        transactions: [],\n        _id: '',\n        imageHex: null,\n        selectedMonth: new Date().getMonth(),\n        selectedYear: new Date().getFullYear(),\n        updateUserData: this.updateUserData,\n        logInSuccess: this.logInSuccess,\n        setJwt: this.setJwt,\n        signOut: this.signOut,\n        getUserData: this.getUserData,\n        requestUpdate: this.requestUpdate,\n        updateSelectedMonth: this.updateSelectedMonth,\n        updateSelectedYear: this.updateSelectedYear,\n    };\n\n    \n\n    render(){\n        return(\n            <UserContext.Provider value={this.state}>\n                {this.props.children}\n            </UserContext.Provider>\n        )\n    };\n};\n\nexport const UserConsumer = UserContext.Consumer;"]},"metadata":{},"sourceType":"module"}