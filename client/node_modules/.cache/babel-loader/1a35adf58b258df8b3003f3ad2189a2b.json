{"ast":null,"code":"var _jsxFileName = \"/home/clinnygee/Documents/portfolio-projects/expense-tracker/src/user-context.js\";\nimport React, { createContext } from 'react';\nconst UserContext = createContext({\n  username: '',\n  transactions: [],\n  _id: '',\n  authenticated: false,\n  jwt: '',\n  updateUserData: () => {},\n  logInSuccess: () => {},\n  setJwt: () => {},\n  getUserData: () => {},\n  requestUpdate: () => {},\n  selectedMonth: '',\n  selectedYear: '',\n  updateSelectedMonth: () => {},\n  updateSelectedYear: () => {}\n});\nexport class UserProvider extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.updateUserData = newUserData => {\n      console.log(newUserData);\n      this.setState({\n        username: newUserData.username,\n        transactions: newUserData.transactions,\n        _id: newUserData._id\n      });\n    };\n\n    this.logInSuccess = () => {\n      console.log('in context loginsuccess');\n      this.setState({\n        authenticated: true\n      });\n      this.getUserData();\n    };\n\n    this.setJwt = jwt => {\n      console.log('in context setjwt');\n      this.setState({\n        jwt: jwt\n      });\n    };\n\n    this.getUserData = () => {\n      let token = sessionStorage.getItem('jwt');\n      fetch('/dashboard', {\n        method: 'GET',\n        headers: {\n          'content-type': 'application/json',\n          'Authorization': \"Bearer \".concat(token)\n        }\n      }).then(response => {\n        return response.json();\n      }).then(parsedJson => {\n        console.log(parsedJson);\n        this.updateUserData(parsedJson); // this.setTransactionData(parsedJson.transactions);\n      });\n    };\n\n    this.requestUpdate = () => {\n      console.log('update requested');\n      this.getUserData();\n    };\n\n    this.updateSelectedMonth = month => {\n      console.log('in updateSelectedMonth, month: ' + this.state.selectedMonth);\n      this.setState({\n        selectedMonth: month\n      });\n    };\n\n    this.updateSelectedYear = year => {\n      console.log('in updateSelected year, year: ' + this.state.selectedYear);\n      this.setState({\n        selectedYear: year\n      });\n    };\n\n    this.state = {\n      username: '',\n      transactions: [],\n      _id: '',\n      selectedMonth: new Date().getMonth(),\n      selectedYear: new Date().getFullYear(),\n      updateUserData: this.updateUserData,\n      logInSuccess: this.logInSuccess,\n      setJwt: this.setJwt,\n      getUserData: this.getUserData,\n      requestUpdate: this.requestUpdate,\n      updateSelectedMonth: this.updateSelectedMonth,\n      updateSelectedYear: this.updateSelectedYear\n    };\n  }\n\n  render() {\n    return React.createElement(UserContext.Provider, {\n      value: this.state,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, this.props.children);\n  }\n\n}\n;\nexport const UserConsumer = UserContext.Consumer;","map":{"version":3,"sources":["/home/clinnygee/Documents/portfolio-projects/expense-tracker/src/user-context.js"],"names":["React","createContext","UserContext","username","transactions","_id","authenticated","jwt","updateUserData","logInSuccess","setJwt","getUserData","requestUpdate","selectedMonth","selectedYear","updateSelectedMonth","updateSelectedYear","UserProvider","Component","newUserData","console","log","setState","token","sessionStorage","getItem","fetch","method","headers","then","response","json","parsedJson","month","state","year","Date","getMonth","getFullYear","render","props","children","UserConsumer","Consumer"],"mappings":"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","sourcesContent":["import React, {createContext} from 'react';\n\n\nconst UserContext = createContext({\n    username: '',\n    transactions: [],\n    _id: '',\n    authenticated: false,\n    jwt: '',\n    updateUserData: () => {},\n    logInSuccess: () => {},\n    setJwt: () => {},\n    getUserData: () => {},\n    requestUpdate: () => {},\n    selectedMonth: '',\n    selectedYear: '',\n    updateSelectedMonth: () => {},\n    updateSelectedYear: () => {},\n});\n\nexport class UserProvider extends React.Component {\n\n    \n    // Change this to be a fetch call, so it can be called when a refresh is required when data is changed on the server, \n    // and when the user successfully logs in\n    updateUserData = newUserData => {\n        console.log(newUserData);\n        this.setState({username: newUserData.username, transactions: newUserData.transactions, _id: newUserData._id})\n    };\n    // When this is called, call the function to fetch user data.\n    logInSuccess = () => {\n        console.log('in context loginsuccess')\n        this.setState({authenticated: true});\n        this.getUserData()\n        \n    };\n\n    setJwt = jwt => {\n        console.log('in context setjwt')\n        this.setState({jwt: jwt});\n    };\n\n    getUserData = () => {\n        let token = sessionStorage.getItem('jwt');\n\n        fetch('/dashboard', {\n            method: 'GET',\n            headers: {\n                'content-type': 'application/json',\n                'Authorization': `Bearer ${token}`,\n            }\n        }).then(response => {\n            return response.json();\n        }).then(parsedJson => {\n            console.log(parsedJson);\n            this.updateUserData(parsedJson);\n            // this.setTransactionData(parsedJson.transactions);\n        })\n    };\n\n    requestUpdate = () => {\n        console.log('update requested');\n        this.getUserData();\n    }\n\n    updateSelectedMonth = (month) => {\n        console.log('in updateSelectedMonth, month: ' + this.state.selectedMonth)\n        this.setState({selectedMonth: month});\n    };\n\n    updateSelectedYear = (year) => {\n        console.log('in updateSelected year, year: ' + this.state.selectedYear)\n        this.setState({selectedYear: year});\n    };\n\n    state = {\n        username: '',\n        transactions: [],\n        _id: '',\n        selectedMonth: new Date().getMonth(),\n        selectedYear: new Date().getFullYear(),\n        updateUserData: this.updateUserData,\n        logInSuccess: this.logInSuccess,\n        setJwt: this.setJwt,\n        getUserData: this.getUserData,\n        requestUpdate: this.requestUpdate,\n        updateSelectedMonth: this.updateSelectedMonth,\n        updateSelectedYear: this.updateSelectedYear,\n    };\n\n    \n\n    render(){\n        return(\n            <UserContext.Provider value={this.state}>\n                {this.props.children}\n            </UserContext.Provider>\n        )\n    };\n};\n\nexport const UserConsumer = UserContext.Consumer;"]},"metadata":{},"sourceType":"module"}